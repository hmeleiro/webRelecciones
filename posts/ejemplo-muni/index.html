<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  

  <link rel="icon" type="image/png" href="https://r-elecciones.netlify.com/favicon.png">

  <title>
    
    
     Ejemplo: municipios() 
    
  </title>
  <link rel="canonical" href="https://r-elecciones.netlify.com/posts/ejemplo-muni/">

  <link rel="stylesheet" href="https://r-elecciones.netlify.com/css/fonts.css" />
  <link rel="stylesheet" href="https://r-elecciones.netlify.com/css/style.css" />

  
</head>

<body>
<section id=nav>
  <h1><a href="https://r-elecciones.netlify.com/">R-elecciones.</a></h1>
  <ul>
    
    <li><a href="https://r-elecciones.netlify.com/posts/">Algunos ejemplos</a></li>
    
    <li><a href="https://github.com/hmeleiro/elecciones">GitHub</a></li>
    
    <li><a href="https://github.com/hmeleiro/elecciones/issues">Issues</a></li>
    
    <li><a href="https://twitter.com/hmeleiros">Twitter</a></li>
    
    <li><a href="https://hmeleiro.github.io">Autor</a></li>
    
  </ul>
</section>


<section id=content>
  <h1> Ejemplo: municipios() </h1>

  <div id=sub-header>
    Héctor Meleiro · 03/02/2019 · 5 minute read
  </div>

  <div class="entry-content">
    
<script src="https://r-elecciones.netlify.com/rmarkdown-libs/kePrint/kePrint.js"></script>


<div id="cargar-las-librerias" class="section level2">
<h2>Cargar las librerías</h2>
<p>Instalo la librería <a href="https://github.com/hmeleiro/elecciones">R-elecciones</a> y cargo las librerías.</p>
<pre class="r"><code>#devtools::install_github(&quot;hmeleiro/elecciones&quot;) # &lt;--- Instala la librería elecciones

library(elecciones)
# Cargo el resto de librerías
library(sf)
library(tidyverse)
library(mapdeck)
library(knitr)
library(kableExtra)</code></pre>
</div>
<div id="descargar-los-resultados" class="section level2">
<h2>Descargar los resultados</h2>
<p>Me descargo los resultados a nivel de mesa de las elecciones municipales de mayo de 2015 y me quedo solo con los de la ciudad de Madrid.</p>
<pre class="r"><code>results &lt;- municipios(&quot;generales&quot;, &quot;2015&quot;, &quot;12&quot;) # Descargo los datos


ktab &lt;- kable(head(results), digits = 4, align = &quot;l&quot;, row.names = F)
kable_styling(ktab, bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;)) %&gt;% scroll_box(width = &quot;100%&quot;, height = &quot;200px&quot;)</code></pre>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
eleccion
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
mes
</th>
<th style="text-align:left;">
partido
</th>
<th style="text-align:left;">
provincia
</th>
<th style="text-align:left;">
municipio
</th>
<th style="text-align:left;">
distrito
</th>
<th style="text-align:left;">
CODIGOINE
</th>
<th style="text-align:left;">
ccaa
</th>
<th style="text-align:left;">
nombre.municipio
</th>
<th style="text-align:left;">
comarca
</th>
<th style="text-align:left;">
pob.derecho
</th>
<th style="text-align:left;">
n.mesas
</th>
<th style="text-align:left;">
censo.INE
</th>
<th style="text-align:left;">
INE.escrutinio
</th>
<th style="text-align:left;">
CERE.escrutinio
</th>
<th style="text-align:left;">
CERE.votantes
</th>
<th style="text-align:left;">
participacion1
</th>
<th style="text-align:left;">
participacion2
</th>
<th style="text-align:left;">
blancos
</th>
<th style="text-align:left;">
nulos
</th>
<th style="text-align:left;">
candidaturas
</th>
<th style="text-align:left;">
nconcejales
</th>
<th style="text-align:left;">
oficiales
</th>
<th style="text-align:left;">
votos
</th>
<th style="text-align:left;">
concejales
</th>
<th style="text-align:left;">
siglas
</th>
<th style="text-align:left;">
denominacion
</th>
<th style="text-align:left;">
code.provincia
</th>
<th style="text-align:left;">
code.autonomia
</th>
<th style="text-align:left;">
code.nacional
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
017
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35017
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
PUERTO DEL ROSARIO
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
36790
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
25447
</td>
<td style="text-align:left;">
25447
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
5918
</td>
<td style="text-align:left;">
10562
</td>
<td style="text-align:left;">
127
</td>
<td style="text-align:left;">
336
</td>
<td style="text-align:left;">
14952
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
032
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35032
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
VALLESECO
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
3886
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
3432
</td>
<td style="text-align:left;">
3432
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1184
</td>
<td style="text-align:left;">
1968
</td>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
2479
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
010
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35010
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
HARÍA
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
4736
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
3548
</td>
<td style="text-align:left;">
3548
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
863
</td>
<td style="text-align:left;">
1594
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
2316
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
009
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35009
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
GÁLDAR
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
24209
</td>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
19832
</td>
<td style="text-align:left;">
19832
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6048
</td>
<td style="text-align:left;">
10494
</td>
<td style="text-align:left;">
97
</td>
<td style="text-align:left;">
269
</td>
<td style="text-align:left;">
13939
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
003
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35003
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
ANTIGUA
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
11643
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
5125
</td>
<td style="text-align:left;">
5125
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1020
</td>
<td style="text-align:left;">
2007
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
60
</td>
<td style="text-align:left;">
2908
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
<tr>
<td style="text-align:left;">
02
</td>
<td style="text-align:left;">
2015
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
000002
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
031
</td>
<td style="text-align:left;">
99
</td>
<td style="text-align:left;">
35031
</td>
<td style="text-align:left;">
05
</td>
<td style="text-align:left;">
VALSEQUILLO DE GRAN CANARIA
</td>
<td style="text-align:left;">
000
</td>
<td style="text-align:left;">
9233
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
7270
</td>
<td style="text-align:left;">
7270
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2197
</td>
<td style="text-align:left;">
3851
</td>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
184
</td>
<td style="text-align:left;">
4964
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
CANARIAS DE
</td>
<td style="text-align:left;">
CANARIAS DECIDE: LOS VERDES, UNIDAD DEL PUEBLO Y A
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
<td style="text-align:left;">
904714
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="importar-el-shapefile" class="section level2">
<h2>Importar el shapefile</h2>
<p>Importo el shapefile de la Comunidad de Madrid y selecciono solo la ciudad de Madrid. El shapefile se puede descargar en la web del <a href="http://www.madrid.org/nomecalles/DescargaBDTCorte.icm">Instituto de Estadística de la Comunidad de Madrid</a>.</p>
<pre class="r"><code>shp &lt;- read_sf(&quot;~/Downloads/Municipios_IGN/Municipios_IGN.shp&quot;, quiet = T) ### Importo el shapefile 
#shp &lt;-  st_transform(shp, 4326)  # Transformo la proyección</code></pre>
</div>
<div id="agrupar-las-mesas-en-secciones" class="section level2">
<h2>Agrupar las mesas en secciones</h2>
<p>Los datos se descargan a nivel de mesa electoral pero yo los quiero a nivel de sección censal. Así que agrupo los datos y me quedo solo con los cinco partidos más votados.</p>
<pre class="r"><code># Recodifico las siglas para agrupar las diferentes denominaciones de los cinco partidos nacionales
results$siglas_r &lt;- NA
results$siglas_r &lt;- results$siglas

df &lt;- results[str_detect(results$denominacion, &quot;PARTIDO POPULAR&quot;),]
idsPP &lt;- unique(df$code.nacional)
results$siglas_r[results$code.nacional %in% idsPP] &lt;- &quot;PP&quot;


df &lt;- results[str_detect(results$denominacion, &quot;SOCIALIST&quot;),]
idsPSOE &lt;- unique(df$code.nacional)
results$siglas_r[results$code.nacional %in% idsPSOE] &lt;- &quot;PSOE&quot;


df &lt;- results[str_detect(results$siglas, &quot;PODEMOS|EN COMÚ&quot;),]
idsPs &lt;- unique(df$code.nacional)
results$siglas_r[results$code.nacional %in% idsPs] &lt;- &quot;Podemos +confluencias&quot;


df &lt;- results[str_detect(results$siglas, &quot;C&#39;s|C´s&quot;),]
idsCs &lt;- unique(df$code.nacional)
results$siglas_r[results$code.nacional %in% idsCs] &lt;- &quot;C&#39;s&quot;


df &lt;- results[str_detect(results$denominacion, &quot;UNIDAD POPULAR&quot;),]
idsIU &lt;- unique(df$code.nacional)
results$siglas_r[results$code.nacional %in% idsIU] &lt;- &quot;IU&quot;

ids &lt;- c(idsPP, idsPSOE, idsPs, idsCs, idsIU)



# Selecciono a los cinco partidos
results &lt;- results[results$code.nacional %in% c(ids),]


results &lt;- results %&gt;% 
  group_by(CODIGOINE, siglas_r) %&gt;% 
  summarise(censo = sum(censo.INE), 
            votos.candidatura = sum(candidaturas), 
            votos = sum(votos))


# Transformo los datos de formato long a wide 
results &lt;- spread(results, key = siglas_r, value = votos)

# Calculo los % sobre censo
results$PP_pct &lt;- round((results$PP / results$censo ) * 100, 2)
results$PSOE_pct &lt;- round(( results$PSOE / results$censo ) * 100, 2)
results$Ps_pct &lt;- round(( results$`Podemos +confluencias` / results$censo ) * 100, 2)
results$Cs_pct &lt;- round(( results$`C&#39;s` / results$censo ) * 100, 2)
results$IU_pct &lt;- round(( results$IU / results$censo ) * 100, 2)


ktab &lt;- kable(head(results), digits = 4, align = &quot;l&quot;, row.names = F)
kable_styling(ktab, bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;)) %&gt;% scroll_box(width = &quot;100%&quot;, height = &quot;200px&quot;)</code></pre>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
CODIGOINE
</th>
<th style="text-align:left;">
censo
</th>
<th style="text-align:left;">
votos.candidatura
</th>
<th style="text-align:left;">
C’s
</th>
<th style="text-align:left;">
IU
</th>
<th style="text-align:left;">
Podemos +confluencias
</th>
<th style="text-align:left;">
PP
</th>
<th style="text-align:left;">
PSOE
</th>
<th style="text-align:left;">
PP_pct
</th>
<th style="text-align:left;">
PSOE_pct
</th>
<th style="text-align:left;">
Ps_pct
</th>
<th style="text-align:left;">
Cs_pct
</th>
<th style="text-align:left;">
IU_pct
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
01001
</td>
<td style="text-align:left;">
1984
</td>
<td style="text-align:left;">
1397
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
449
</td>
<td style="text-align:left;">
151
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
7.61
</td>
<td style="text-align:left;">
9.88
</td>
<td style="text-align:left;">
22.63
</td>
<td style="text-align:left;">
4.08
</td>
<td style="text-align:left;">
2.37
</td>
</tr>
<tr>
<td style="text-align:left;">
01002
</td>
<td style="text-align:left;">
8139
</td>
<td style="text-align:left;">
5846
</td>
<td style="text-align:left;">
156
</td>
<td style="text-align:left;">
161
</td>
<td style="text-align:left;">
1685
</td>
<td style="text-align:left;">
501
</td>
<td style="text-align:left;">
575
</td>
<td style="text-align:left;">
6.16
</td>
<td style="text-align:left;">
7.06
</td>
<td style="text-align:left;">
20.70
</td>
<td style="text-align:left;">
1.92
</td>
<td style="text-align:left;">
1.98
</td>
</tr>
<tr>
<td style="text-align:left;">
01003
</td>
<td style="text-align:left;">
1186
</td>
<td style="text-align:left;">
814
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
122
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
0.93
</td>
<td style="text-align:left;">
0.84
</td>
<td style="text-align:left;">
10.29
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
1.26
</td>
</tr>
<tr>
<td style="text-align:left;">
01004
</td>
<td style="text-align:left;">
1405
</td>
<td style="text-align:left;">
1003
</td>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
264
</td>
<td style="text-align:left;">
121
</td>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
8.61
</td>
<td style="text-align:left;">
4.63
</td>
<td style="text-align:left;">
18.79
</td>
<td style="text-align:left;">
2.42
</td>
<td style="text-align:left;">
1.42
</td>
</tr>
<tr>
<td style="text-align:left;">
01006
</td>
<td style="text-align:left;">
176
</td>
<td style="text-align:left;">
140
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
18.75
</td>
<td style="text-align:left;">
8.52
</td>
<td style="text-align:left;">
28.41
</td>
<td style="text-align:left;">
10.23
</td>
<td style="text-align:left;">
2.27
</td>
</tr>
<tr>
<td style="text-align:left;">
01008
</td>
<td style="text-align:left;">
790
</td>
<td style="text-align:left;">
529
</td>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
100
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
12.15
</td>
<td style="text-align:left;">
4.68
</td>
<td style="text-align:left;">
12.66
</td>
<td style="text-align:left;">
3.92
</td>
<td style="text-align:left;">
1.77
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="fusiono-los-datos-con-el-shapefile" class="section level2">
<h2>Fusiono los datos con el shapefile</h2>
<p>Creo una columna en el data frame de los resultados electorales con valores identificadores de cada seccion censal que ya está presente en el shapefile para fusionar datos y shapefile.</p>
<pre class="r"><code>shp &lt;- merge(shp, results, by = &quot;CODIGOINE&quot;)

peninbal &lt;- shp[!substr(shp$CODIGOINE, 1, 2) %in% c(&quot;35&quot;, &quot;38&quot;), ]</code></pre>
</div>
<div id="visualizamos" class="section level2">
<h2>Visualizamos</h2>
<p>Uso la librería <a href="https://github.com/mtennekes/tmap">tmap</a> para visualizar un mapa del voto a Ahora Madrid.</p>
<pre class="r"><code>colores5 &lt;- list(c(&quot;#ededed&quot;, &quot;#0cb2ff&quot;), # PP
                 c(&quot;#ededed&quot;, &quot;#E01021&quot;), # PSOE
                 c(&quot;#ededed&quot;, &quot;#612d62&quot;), # Podemos
                 c(&quot;#ededed&quot;, &quot;#E85B2D&quot;), # Cs
                 c(&quot;#ededed&quot;, &quot;#E01021&quot;)) # IU


breaks &lt;- c(0,10,30,50,70)

library(tmap)
mapa &lt;- tm_shape(peninbal) + 
  tm_polygons(col = c(&quot;PP_pct&quot;, &quot;PSOE_pct&quot;, &quot;Ps_pct&quot;, &quot;Cs_pct&quot;, &quot;IU_pct&quot;), style = &quot;fixed&quot;, 
              palette = colores5, breaks = breaks,
              title = &quot;% sobre censo&quot;, 
              border.alpha = 0, lwd = 0, legend.show = T, legend.outside = T) +
  tm_layout(between.margin = 5, frame = FALSE,
            fontfamily = &quot;Roboto Condensed&quot;, 
            title = c(&quot;Partido Popular&quot;, &quot;PSOE&quot;, &quot;Podemos&quot;, &quot;Ciudadanos&quot;, &quot;Izquierda Unida&quot;)) +
  tm_legend(legend.text.size = 1, 
            legend.title.size = 1, 
            legend.title.fontface = &quot;bold&quot;) +
  tm_facets(sync = TRUE, ncol = 2)
mapa</code></pre>
<p><img src="https://r-elecciones.netlify.com/posts/2019-02-02-ejemplo-muni_files/figure-html/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="bola-extra-canarias" class="section level1">
<h1>Bola Extra: Canarias!</h1>
<pre class="r"><code>canarias &lt;- shp[substr(shp$CODIGOINE, 1, 2) %in% c(&quot;35&quot;, &quot;38&quot;), ]


colores5 &lt;- list(c(&quot;#ededed&quot;, &quot;#0cb2ff&quot;), # PP
                 c(&quot;#ededed&quot;, &quot;#E01021&quot;), # PSOE
                 c(&quot;#ededed&quot;, &quot;#612d62&quot;), # Podemos
                 c(&quot;#ededed&quot;, &quot;#E85B2D&quot;), # Cs
                 c(&quot;#ededed&quot;, &quot;#E01021&quot;)) # IU


breaks &lt;- c(0,10,30,50,70)

library(tmap)
mapa &lt;- tm_shape(canarias) + 
  tm_polygons(col = c(&quot;PP_pct&quot;, &quot;PSOE_pct&quot;, &quot;Ps_pct&quot;, &quot;Cs_pct&quot;, &quot;IU_pct&quot;), style = &quot;fixed&quot;, 
              palette = colores5, breaks = breaks,
              title = &quot;% sobre censo&quot;, 
              border.alpha = 0, lwd = 0, legend.show = T, legend.outside = T) +
  tm_layout(between.margin = 5, frame = FALSE,
            fontfamily = &quot;Roboto Condensed&quot;, 
            title = c(&quot;Partido Popular&quot;, &quot;PSOE&quot;,&quot;Podemos&quot;, &quot;Ciudadanos&quot;, &quot;Izquierda Unida&quot;)) +
  tm_legend(legend.text.size = 1, 
            legend.title.size = 1, 
            legend.title.fontface = &quot;bold&quot;) +
  tm_facets(sync = TRUE, ncol = 2)
mapa</code></pre>
<p><img src="https://r-elecciones.netlify.com/posts/2019-02-02-ejemplo-muni_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>

  </div>

</section>

<section id="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
      
      
      if (window.location.hostname == "localhost")
                return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = '';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


  
  
<script src="https://r-elecciones.netlify.com/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>



</body>
</html>

